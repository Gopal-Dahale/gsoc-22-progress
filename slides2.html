<!DOCTYPE html>
<html lang="en-US">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Fused Transfer Learning with Quantum | GSoC 22 Progress</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="Fused Transfer Learning with Quantum">
<meta name="author" content="Gopal-Dahale">
<meta property="og:locale" content="en_US">
<meta name="description" content="This is a very personal blog. I don’t write blogs for anyone, but just record what I do or what I think. So there are many things wrong and you may have different thoughts. It would be nice if I share knowledge and thoughts rather than criticism. It will be great help if you give and teach your knowledge and thoughts to me.">
<meta property="og:description" content="This is a very personal blog. I don’t write blogs for anyone, but just record what I do or what I think. So there are many things wrong and you may have different thoughts. It would be nice if I share knowledge and thoughts rather than criticism. It will be great help if you give and teach your knowledge and thoughts to me.">
<link rel="canonical" href="https://gopal-dahale.github.io/slides2.html">
<meta property="og:url" content="https://gopal-dahale.github.io/slides2.html">
<meta property="og:site_name" content="GSoC 22 Progress">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Fused Transfer Learning with Quantum">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Gopal-Dahale"},"description":"This is a very personal blog. I don’t write blogs for anyone, but just record what I do or what I think. So there are many things wrong and you may have different thoughts. It would be nice if I share knowledge and thoughts rather than criticism. It will be great help if you give and teach your knowledge and thoughts to me.","headline":"Fused Transfer Learning with Quantum","url":"https://gopal-dahale.github.io/slides2.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&amp;display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css?v=ead1a8c5e05b6fd821b7a05f0e824ac2c077bf00">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  <script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <h1 class="project-name">Fused Transfer Learning with Quantum</h1>
      <h2 class="project-tagline">This is a very personal blog. I don't write blogs for anyone, but just record what I do or what I think. So there are many things wrong and you may have different thoughts. It would be nice if I share knowledge and thoughts rather than criticism. It will be great help if you give and teach your knowledge and thoughts to me.</h2>
      
        <a href="https://github.com/Gopal-Dahale/gsoc-22-progress" class="btn">View on GitHub</a>
      
      
    </header>

    <main id="content" class="main-content" role="main">
      <h1 id="fused-transfer-learning-with-quantum">Fused Transfer Learning with Quantum</h1>

<hr>
<p>revealOptions:
  transition: ‘fade’
  transitionSpeed: ‘fast’
  width: 1400
—</p>
<style>
.container{
    display: flex;
}
.col{
    flex: 1;
}
.small-font{
    font-size:25px;
}
</style>

<h2 id="classical-models">Classical Models</h2>

<p>ElectronPhoton Energy channel - ResnetV1 - Depths 20, 44 - 40 epochs</p>

<table>
  <thead>
    <tr>
      <th>Depth</th>
      <th>Acc</th>
      <th>Val acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>20</td>
      <td>0.8</td>
      <td>0 .64</td>
    </tr>
    <tr>
      <td>44</td>
      <td>0.79</td>
      <td>0.626</td>
    </tr>
  </tbody>
</table>

<div>
<img src="images/ep-resnetv1/accuracy.png" height="auto" width="400px">
<img src="images/ep-resnetv1/loss.png" height="auto" width="400px">
<img src="images/ep-resnetv1/val_acc.png" height="auto" width="400px">
</div>

<hr>

<h2 id="results-on-pretrained-model">Results on Pretrained model</h2>

<ul>
  <li>Resnet50 $\rightarrow$ 512 $\rightarrow$ 128 $\rightarrow$ 2</li>
  <li>Pretrained on ImageNet</li>
  <li>Using Log scaling with Ranger Optimizer</li>
  <li>Acc: 0.5, Val Acc: 0.5</li>
</ul>

<div>
<img src="images/ep-resnet50/acc.png" height="auto" width="400px">
<img src="images/ep-resnet50/loss.png" height="auto" width="400px">
<img src="images/ep-resnet50/val_acc.png" height="auto" width="400px">
</div>
<hr>

<h2 id="results-on-quantum-cnn">Results on Quantum CNN</h2>

<ul>
  <li>Mini Mnist
    <ul>
      <li>0 1 images</li>
      <li>200 images per class</li>
      <li>Center cropped $\rightarrow$ (20,20)</li>
      <li>Resized $\rightarrow$ (8,8)</li>
    </ul>
  </li>
  <li>Sweep using Chen Ansatz (3 layers). Using DRC.</li>
  <li>Feature maps: Amplitude, Angle, Basis.</li>
  <li>10 epochs</li>
</ul>

<hr>

<h3 id="quantum-cnn">Quantum CNN</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Model: "QCNN-AmplitudeMap-Chen"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_1 (InputLayer)        [(None, 8, 8, 1)]         0
 qconv2d_1 (QConv2D)         (None, 4, 4, 1)           81
 flatten (Flatten)           (None, 16)                0
 TwoLayerPQC (TwoLayerPQC)   (None, 1)                 81
=================================================================
Total params: 162
Trainable params: 72
Non-trainable params: 90
_________________________________________________________________
</code></pre></div></div>

<div class="container">

<div class="col">
<img src="images/ansatz2.png" height="auto" width="450px">
</div>

<div class="col">
<ul>
    <li>Kernel: (3,3)</li>
    <li>Strides: (2,2)</li>
    <li>Op: -0.5*Z + 0.5*I</li>

</ul>
</div>
</div>

<hr>

<h3 id="results">Results</h3>

<table>
  <thead>
    <tr>
      <th>Feature Map</th>
      <th>Acc</th>
      <th>Val acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Amp</td>
      <td>0.9375</td>
      <td>0 .933</td>
    </tr>
    <tr>
      <td>Angle</td>
      <td>0.9896</td>
      <td>0.9917</td>
    </tr>
    <tr>
      <td>Basis</td>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>

<p>BasisMap without DRC gives the same scores.</p>

<div>
<img src="images/mmnist-qcnn-chen/acc.png" height="auto" width="380px">
<img src="images/mmnist-qcnn-chen/loss.png" height="auto" width="380px">
<img src="images/mmnist-qcnn-chen/val_acc.png" height="auto" width="380px">
</div>

<hr>

<h4 id="qcnn-on-ep"><span style="color: #F19C99">QCNN on EP</span></h4>

<ul>
  <li>ElectronPhoton (only 900 train images)
    <ul>
      <li>Center cropped $\rightarrow$ (8,8)</li>
      <li>Log Scaling followed by min max scaling</li>
    </ul>
  </li>
  <li>Same Ansatz as previous (Not using DRC)</li>
  <li>AngleMap</li>
  <li>20 epochs</li>
  <li>Acc: 0.61, Val Acc: 0.53</li>
</ul>

<div>
<img src="images/mep-qcnn-chen/acc.png" height="auto" width="400px">
<img src="images/mep-qcnn-chen/loss.png" height="auto" width="400px">
<img src="images/mep-qcnn-chen/val_acc.png" height="auto" width="400px">
</div>
<hr>

<h2 id="more-architectures"><span style="color: #7EA6E0">More Architectures</span></h2>

<ul>
  <li>Created QCNN hybrid model with FC layers at the end. (yet to test)</li>
  <li>Created a new ansatz TTN.</li>
</ul>

<div>
<img src="images/ttn.png" height="auto" width="400px">
</div>

<hr>

<h2 id="feature-engineering-ep"><span style="color: #7EA6E0">Feature engineering EP</span></h2>

<ul>
  <li>Flattened images into rows. Created a dataframe.</li>
  <li>Correlation of all columns with target.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>target         1.000000
ind-(16,16)    0.153360
ind-(16,15)    0.120210
ind-(16,18)    0.104080
ind-(16,17)    0.065687
Name: target, dtype: float64
</code></pre></div></div>
<ul>
  <li>Tried feature Agglomeration using xgboost as classifier</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cluster: 1 train acc is: 68.36 prediction acc is: 49.60
cluster: 5 train acc is: 86.11 prediction acc is: 59.90
cluster: 6 train acc is: 88.34 prediction acc is: 59.40
cluster: 7 train acc is: 90.44 prediction acc is: 64.30
</code></pre></div></div>
<hr>

<h2 id="contd"><span style="color: #FFB570">Contd.</span></h2>

<ul>
  <li>Train scores are higher than predicition scores.</li>
  <li>Even by restricting the number of features test scores does not increase.</li>
  <li>Need to spend more than on feature engineering on the dataset.</li>
</ul>

<hr>

<h2 id="status">Status</h2>
<div class="container">

<div class="col">
<span style="color:#97D077"> Done: </span>

- Preliminary results on MNIST and EP (classical &amp; quantum).
- Tried transfer learning.
- Tried feature engineering on EP.
</div>

<div class="col">
<span style="color:#7EA6E0"> Goals for next week: </span>

- Giving attention to EP.
- Transfer learning with VQC.
- Testing EP with TTN.
- Using QCNN Hybrid with EP.
</div>

<div class="col">
<span style="color:#F19C99"> Questions: </span>

- Any suggestions on how to feature engineer EP?
- Any other feedback?

</div>

</div>

<hr>

<h2 id="references">References</h2>

<ul>
  <li>Cong, I., Choi, S. &amp; Lukin, M.D. Quantum convolutional neural networks. Nat. Phys. 15, 1273–1278 (2019). https://doi.org/10.1038/s41567-019-0648-8</li>
  <li>S.~Y.~C.~Chen, T.~C.~Wei, C.~Zhang, H.~Yu and S.~Yoo, ``Quantum convolutional neural networks for high energy physics data analysis,’’ Phys. Rev. Res. \textbf{4} (2022) no.1, 013231 doi:10.1103/PhysRevResearch.4.013231</li>
  <li>Liu, J., Lim, K.H., Wood, K.L. et al. Hybrid quantum-classical convolutional neural networks. Sci. China Phys. Mech. Astron. 64, 290311 (2021). https://doi.org/10.1007/s11433-021-1734-3</li>
  <li>Tüysüz, C., Rieger, C., Novotny, K. et al. Hybrid quantum classical graph neural networks for particle track reconstruction. Quantum Mach. Intell. 3, 29 (2021). https://doi.org/10.1007/s42484-021-00055-9</li>
  <li>Pérez-Salinas, A., Cervera-Lierta, A., Gil-Fuster, E., &amp; Latorre, J. (2020). Data re-uploading for a universal quantum classifier. Quantum, 4, 226.</li>
  <li>Chen, Yusui &amp; Hu, Wenhao &amp; Li, Xiang. (2021). Feasible Architecture for Quantum Fully Convolutional Networks.</li>
  <li>Chen, Yixiong. (2021). QDCNN: Quantum Dilated Convolutional Neural Network.</li>
</ul>



      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="https://github.com/Gopal-Dahale/gsoc-22-progress">gsoc-22-progress</a> is maintained by <a href="https://github.com/Gopal-Dahale">Gopal-Dahale</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>
  </body>
</html>
